# Google Sheets Template System

‡∏£‡∏∞‡∏ö‡∏ö Template ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Sheets ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞ feature ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö

## üéØ Overview

‡∏£‡∏∞‡∏ö‡∏ö Template ‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ:
- ‚úÖ **‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠** - ‡πÅ‡∏ï‡πà‡∏•‡∏∞ feature ‡∏°‡∏µ template ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ
- ‚úÖ **Auto-initialization** - ‡∏™‡∏£‡πâ‡∏≤‡∏á sheet ‡πÅ‡∏•‡∏∞ header ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‚úÖ **Field Mapping** - ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å MongoDB model ‡πÄ‡∏õ‡πá‡∏ô format ‡∏Ç‡∏≠‡∏á Google Sheets
- ‚úÖ **Consistent Format** - ‡πÉ‡∏ä‡πâ format ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å feature
- ‚úÖ **Easy Management** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ templates ‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

## üìã Templates

### 1. ‡πÄ‡∏ö‡∏¥‡∏Å‡∏Ç‡∏≠‡∏á‡πÉ‡∏ô‡∏ï‡∏π‡πâ (WithdrawItems)
```
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | ‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô | ‡∏´‡∏ô‡πà‡∏ß‡∏¢ | ‡πÄ‡∏ö‡∏¥‡∏Å‡πÇ‡∏î‡∏¢ | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ | ID
```

### 2. ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏µ‡πà‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á (TimeTracking)
```
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | ‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏µ‡πà‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á | ‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡∏≥‡∏£‡∏ß‡∏à | ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô | ‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î | ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ô‡∏≤‡∏ó‡∏µ) | ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏î‡∏¢ | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ID
```

### 3. ‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏Ñ‡∏™ (ReportCase)
```
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | ‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î | ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç | ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢ | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡πâ | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢ | ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç | ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏î‡∏¢ | ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô | ID
```

### 4. ‡∏™‡∏ï‡∏≠‡∏£‡∏µ‡πà (Story)
```
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | ‡πÄ‡∏ß‡∏•‡∏≤ | URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ | ‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÇ‡∏î‡∏¢ | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÇ‡∏û‡∏™‡∏ï‡πå | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Likes | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Views | ‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà | ‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ | ID
```

### 5. ‡πÅ‡∏ö‡∏•‡πá‡∏Ñ‡∏•‡∏¥‡∏™ (Blacklist)
```
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | ‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏ä‡∏∑‡πà‡∏≠ | ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• | ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà | ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á | ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏î‡∏¢ | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏° | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ | ID
```

### 6. ‡πÇ‡∏ó‡∏©‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡∏ï‡∏≥‡∏£‡∏ß‡∏à (Discipline)
```
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | ‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≥‡∏£‡∏ß‡∏à | ID ‡∏ï‡∏≥‡∏£‡∏ß‡∏à | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ú‡∏¥‡∏î | ‡πÇ‡∏ó‡∏© | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏ó‡∏© | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô | ‡∏≠‡∏≠‡∏Å‡πÇ‡∏î‡∏¢ | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏≠‡∏≠‡∏Å | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏≠‡∏∏‡∏ó‡∏ò‡∏£‡∏ì‡πå | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ | ID
```

### 7. ‡πÄ‡∏™‡∏ô‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô (Suggestions)
```
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | ‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ | ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ | ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà | ‡πÄ‡∏™‡∏ô‡∏≠‡πÇ‡∏î‡∏¢ | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ô‡∏≠ | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Likes | ‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠ | ID
```

### 8. ‡πÅ‡∏à‡πâ‡∏á‡∏•‡∏≤ (Leave)
```
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | ‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏≤ | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏≤ | ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏° | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô | ‡∏£‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡πÇ‡∏î‡∏¢ | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡πâ‡∏≠‡∏á‡∏Ç‡∏≠ | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö | ID
```

### 9. ‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏Ñ‡∏ä (Cash)
```
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | ‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î | ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà | ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢ | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÇ‡∏î‡∏¢ | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô | ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ | ID
```

### 10. ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏°‡πã‡∏≠ (Bonus)
```
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | ‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô | ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏´‡∏°‡πã‡∏≠ | ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö | ID ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö | ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢ | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÇ‡∏î‡∏¢ | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ | ID
```

### 11. ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (Notifications)
```
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | ‡πÄ‡∏ß‡∏•‡∏≤ | ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ | ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó | ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö | ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö | ID ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á | ‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç | URL ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥ | ‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ | ID
```

### 12. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ï‡∏≠‡∏£‡∏µ‡πà (LogStory)
```
‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà | ‡πÄ‡∏ß‡∏•‡∏≤ | Team A Type | Team A Name | Team B Type | Team B Name | Status | Negotiation Date | Observer Police (Negotiation) | Explain Police | Entourage Police | Field Work Start Date | Field Work End Date | Observer Police (Field Work) | Head Story 1 | Head Story 2 | Head Story 3 | Intern Story 1 | Intern Story 2 | Intern Story 3 | ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏î‡∏¢ | ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
```

## üöÄ Usage

### 1. ‡πÉ‡∏ä‡πâ Helper Functions

```typescript
import { saveWithdrawItemToSheet } from '@/lib/google-sheets-helpers';

// ‡πÉ‡∏ô API route
await saveWithdrawItemToSheet({
  ...item.toObject(),
  withdrawnByName: userDoc.name,
});
```

### 2. ‡πÉ‡∏ä‡πâ Template ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á

```typescript
import { appendWithTemplate } from '@/lib/google-sheets';

await appendWithTemplate('WithdrawItems', {
  itemName: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå',
  quantity: 10,
  unit: '‡∏ä‡∏¥‡πâ‡∏ô',
  withdrawnByName: '‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ',
});
```

### 3. Initialize All Templates (Admin Only)

```bash
POST /api/admin/initialize-sheets
```

‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ function:

```typescript
import { initializeAllTemplates } from '@/lib/google-sheets-helpers';

await initializeAllTemplates();
```

## üìÅ File Structure

```
lib/
‚îú‚îÄ‚îÄ google-sheets.ts              # Core Google Sheets functions
‚îú‚îÄ‚îÄ google-sheets-templates.ts    # Template definitions
‚îî‚îÄ‚îÄ google-sheets-helpers.ts      # Helper functions for each feature

app/api/admin/
‚îî‚îÄ‚îÄ initialize-sheets/route.ts    # API endpoint to initialize all templates
```

## üîß Features

### Auto-Initialization
- ‡∏™‡∏£‡πâ‡∏≤‡∏á sheet ‡πÉ‡∏´‡∏°‡πà‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ header row ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- Format header (bold, background color)
- Freeze header row

### Field Mapping
- ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å MongoDB model ‡πÄ‡∏õ‡πá‡∏ô format ‡∏Ç‡∏≠‡∏á Google Sheets
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ date/time formatting
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ boolean values (‡πÉ‡∏ä‡πà/‡πÑ‡∏°‡πà)
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ empty values

### Error Handling
- Graceful fallback ‡∏ñ‡πâ‡∏≤ Google Sheets ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°
- Error logging ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö debugging
- ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ñ‡πâ‡∏≤ backup ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß

## üìä Template Structure

```typescript
interface SheetTemplate {
  sheetName: string;      // ‡∏ä‡∏∑‡πà‡∏≠ sheet
  headers: string[];      // Headers (columns)
  description?: string;   // ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢
}
```

## üé® Header Formatting

‡πÄ‡∏°‡∏∑‡πà‡∏≠ initialize template:
- ‚úÖ **Bold text** - Header row ‡πÄ‡∏õ‡πá‡∏ô bold
- ‚úÖ **Background color** - Header ‡∏°‡∏µ background ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤
- ‚úÖ **Frozen row** - Header row ‡∏ñ‡∏π‡∏Å freeze (‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô)

## üí° Best Practices

1. **‡πÉ‡∏ä‡πâ Helper Functions**
   - ‡πÉ‡∏ä‡πâ `save*ToSheet()` functions ‡πÅ‡∏ó‡∏ô `appendWithTemplate()` ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
   - Helper functions ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ field mapping ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

2. **Error Handling**
   - Wrap ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Google Sheets ‡∏î‡πâ‡∏ß‡∏¢ try-catch
   - ‡πÑ‡∏°‡πà throw error ‡∏ñ‡πâ‡∏≤ backup ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß (‡πÉ‡∏ä‡πâ console.error ‡πÅ‡∏ó‡∏ô)

3. **Initialization**
   - Initialize templates ‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠ Admin ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API
   - ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á initialize ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å

4. **Field Names**
   - ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠ field ‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÉ‡∏ô Google Sheets
   - ‡πÉ‡∏ä‡πâ format ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å template (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà, ‡πÄ‡∏ß‡∏•‡∏≤, ID)

## üîÑ Integration

### ‡πÉ‡∏ô API Routes

```typescript
// app/api/[feature]/route.ts
import { saveWithdrawItemToSheet } from '@/lib/google-sheets-helpers';

// ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á record
try {
  await saveWithdrawItemToSheet({
    ...item.toObject(),
    withdrawnByName: userDoc.name,
  });
} catch (error) {
  console.error('Failed to backup to Google Sheets:', error);
  // ‡πÑ‡∏°‡πà throw - ‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏ï‡πà‡∏≠
}
```

### ‡πÉ‡∏ô Notification Helper

```typescript
// lib/notification-helper.ts
import { saveNotificationToSheet } from '@/lib/google-sheets-helpers';

// ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á notification
try {
  await saveNotificationToSheet(notification.toObject());
} catch (error) {
  console.error('Failed to backup notification:', error);
}
```

## üìù Custom Templates

‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° template ‡πÉ‡∏´‡∏°‡πà:

1. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô `google-sheets-templates.ts`:
```typescript
export const SHEET_TEMPLATES = {
  // ... existing templates
  NewFeature: {
    sheetName: '‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà',
    headers: ['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà', '‡πÄ‡∏ß‡∏•‡∏≤', 'Field1', 'Field2', 'ID'],
    description: '‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢',
  },
};
```

2. ‡∏™‡∏£‡πâ‡∏≤‡∏á helper function ‡πÉ‡∏ô `google-sheets-helpers.ts`:
```typescript
export async function saveNewFeatureToSheet(data: any) {
  try {
    await appendWithTemplate('NewFeature', {
      field1: data.field1,
      field2: data.field2,
      _id: data._id?.toString() || '',
    });
    return true;
  } catch (error) {
    console.error('Failed to save new feature to sheet:', error);
    return false;
  }
}
```

## üêõ Troubleshooting

### Sheet ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Google Sheets credentials
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Spreadsheet ID
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö permissions

### Headers ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á
- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `initializeSheetTemplate()` ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
- ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API `/api/admin/initialize-sheets`

### ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö console logs
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö field mapping
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö data format

## ‚úÖ Template Checklist

- [x] WithdrawItems (‡πÄ‡∏ö‡∏¥‡∏Å‡∏Ç‡∏≠‡∏á‡πÉ‡∏ô‡∏ï‡∏π‡πâ)
- [x] TimeTracking (‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏µ‡πà‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á)
- [x] ReportCase (‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏Ñ‡∏™)
- [x] Story (‡∏™‡∏ï‡∏≠‡∏£‡∏µ‡πà)
- [x] Blacklist (‡πÅ‡∏ö‡∏•‡πá‡∏Ñ‡∏•‡∏¥‡∏™)
- [x] Discipline (‡πÇ‡∏ó‡∏©‡∏ß‡∏¥‡∏ô‡∏±‡∏¢‡∏ï‡∏≥‡∏£‡∏ß‡∏à)
- [x] Suggestions (‡πÄ‡∏™‡∏ô‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô)
- [x] Leave (‡πÅ‡∏à‡πâ‡∏á‡∏•‡∏≤)
- [x] Cash (‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏Ñ‡∏ä)
- [x] Bonus (‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏°‡πã‡∏≠)
- [x] Notifications (‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô)
- [x] LogStory (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ï‡∏≠‡∏£‡∏µ‡πà)

‡∏£‡∏∞‡∏ö‡∏ö Template ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô! üéâ
