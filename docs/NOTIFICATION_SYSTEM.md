# ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (Notification System)

‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö Advanced ‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á Browser Notifications ‡πÅ‡∏•‡∏∞ Toast Notifications

## ‚ú® Features

### 1. Browser Notifications (‡πÄ‡∏î‡πâ‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á)
- ‚úÖ **Native Browser API** - ‡πÉ‡∏ä‡πâ Notification API ‡∏Ç‡∏≠‡∏á Browser
- ‚úÖ **Permission Management** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
- ‚úÖ **Rich Notifications** - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö icon, image, badge, actions
- ‚úÖ **Auto-close** - ‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏á 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏≤‡∏° requireInteraction)
- ‚úÖ **Click Handling** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ click event ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î URL
- ‚úÖ **Vibration** - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
- ‚úÖ **Cross-browser Support** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö browser support

### 2. Toast Notifications (‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö)
- ‚úÖ **React Hot Toast** - ‡πÉ‡∏ä‡πâ react-hot-toast
- ‚úÖ **Type-based Styling** - success, warning, error, info
- ‚úÖ **Custom Duration** - ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏≤‡∏° priority
- ‚úÖ **Position Control** - ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•

### 3. Real-time Updates
- ‚úÖ **Polling System** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- ‚úÖ **Auto-fetch** - ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
- ‚úÖ **Unread Count** - ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡πà‡∏≤‡∏ô
- ‚úÖ **State Management** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ state ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û

### 4. Notification Center UI
- ‚úÖ **Dropdown Interface** - ‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡πÄ‡∏õ‡πá‡∏ô dropdown
- ‚úÖ **Unread/Read Separation** - ‡πÅ‡∏¢‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß/‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡πà‡∏≤‡∏ô
- ‚úÖ **Mark as Read** - ‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£/‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
- ‚úÖ **Priority Badge** - ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
- ‚úÖ **Type Icons** - ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
- ‚úÖ **Click to Open** - ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î action URL

## üìÅ File Structure

```
lib/
‚îú‚îÄ‚îÄ notification-browser.ts    # Browser Notification Manager
‚îî‚îÄ‚îÄ notification-helper.ts     # Server-side notification helpers

hooks/
‚îî‚îÄ‚îÄ useNotifications.ts        # React hook ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö notifications

components/
‚îî‚îÄ‚îÄ NotificationCenter.tsx     # Notification Center UI Component

app/api/notifications/
‚îú‚îÄ‚îÄ route.ts                   # GET, POST notifications
‚îú‚îÄ‚îÄ [id]/read/route.ts         # Mark notification as read
‚îî‚îÄ‚îÄ read-all/route.ts          # Mark all as read
```

## üöÄ Usage

### 1. ‡πÄ‡∏û‡∏¥‡πà‡∏° Notification Center ‡πÉ‡∏ô Layout

```tsx
import NotificationCenter from '@/components/NotificationCenter';

// ‡πÉ‡∏ô Layout component
<NotificationCenter userId={user._id} token={token} />
```

### 2. ‡πÉ‡∏ä‡πâ Notification Hook

```tsx
import { useNotifications } from '@/hooks/useNotifications';

function MyComponent() {
  const { 
    notifications, 
    unreadCount, 
    showNotification,
    markAsRead 
  } = useNotifications({ 
    userId: user._id, 
    token: token,
    autoFetch: true,
    interval: 30000 // 30 seconds
  });

  // Show custom notification
  showNotification(
    '‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠',
    '‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°',
    'success', // type: info | success | warning | error
    {
      requireInteraction: true, // ‡πÑ‡∏°‡πà‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
      vibrate: [200, 100, 200],
    }
  );
}
```

### 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á Notification (Server-side)

```typescript
import { createNotification } from '@/lib/notification-helper';

await createNotification({
  title: '‡πÄ‡∏ö‡∏¥‡∏Å‡∏Ç‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
  message: '‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß 10 ‡∏ä‡∏¥‡πâ‡∏ô',
  type: 'success',
  recipient: userId,
  recipientName: '‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ',
  priority: 'medium',
  actionUrl: '/dashboard/withdraw-items',
  relatedTo: 'withdrawItem',
  relatedId: itemId,
});
```

### 4. ‡∏™‡∏£‡πâ‡∏≤‡∏á Bulk Notifications

```typescript
import { createBulkNotifications } from '@/lib/notification-helper';

await createBulkNotifications(
  [userId1, userId2, userId3],
  {
    title: '‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®',
    message: '‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà',
    type: 'info',
    priority: 'high',
  }
);
```

## üéØ Notification Types

### Browser Notification Options

```typescript
interface BrowserNotificationOptions {
  title: string;
  body: string;
  icon?: string;              // Custom icon URL
  badge?: string;             // Badge icon URL
  image?: string;             // Large image URL
  tag?: string;               // Unique tag for grouping
  requireInteraction?: boolean; // ‡πÑ‡∏°‡πà‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
  silent?: boolean;           // ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏™‡∏µ‡∏¢‡∏á
  vibrate?: number[];         // Pattern ‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏ô
  data?: any;                 // Custom data
  actions?: NotificationAction[]; // Action buttons
}
```

### Toast Notification Types

- **success** - ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (‚úÖ)
- **warning** - ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á (‚ö†Ô∏è)
- **error** - ‡∏™‡∏µ‡πÅ‡∏î‡∏á (‚ùå)
- **info** - ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô (‚ÑπÔ∏è)

## üìä Notification Model

```typescript
{
  _id: string;
  title: string;
  message: string;
  type: 'info' | 'success' | 'warning' | 'error';
  recipient: ObjectId;
  recipientName?: string;
  relatedTo?: string;
  relatedId?: ObjectId;
  isRead: boolean;
  readAt?: Date;
  priority: 'low' | 'medium' | 'high';
  actionUrl?: string;
  expiresAt?: Date;
  createdAt: Date;
  updatedAt: Date;
}
```

## üîß Configuration

### Polling Interval

```tsx
useNotifications({
  interval: 30000, // 30 seconds (default)
});
```

### Permission Request

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠:
- Component mount
- User ‡πÄ‡∏õ‡∏¥‡∏î Notification Center
- User ‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô"

### Auto-close Duration

- **Normal notifications**: 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- **High priority**: ‡∏ï‡∏≤‡∏° requireInteraction (‡πÑ‡∏°‡πà‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)
- **Toast**: 4-6 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (‡∏ï‡∏≤‡∏° type)

## üé® UI Components

### NotificationCenter

‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô (fixed position)

```tsx
<NotificationCenter userId={user._id} token={token} />
```

Features:
- ‚úÖ Bell icon ‡∏û‡∏£‡πâ‡∏≠‡∏° unread badge
- ‚úÖ Dropdown list
- ‚úÖ Unread/Read separation
- ‚úÖ Mark as read buttons
- ‚úÖ Permission request UI

## üîê Security

- ‚úÖ **Authentication Required** - ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ token
- ‚úÖ **User Isolation** - ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞ notification ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
- ‚úÖ **Permission Check** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏™‡∏î‡∏á browser notification

## üìà Performance

- ‚úÖ **Efficient Polling** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞ unread
- ‚úÖ **Lazy Loading** - ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ
- ‚úÖ **State Caching** - Cache notifications ‡πÉ‡∏ô state
- ‚úÖ **Indexed Queries** - MongoDB indexes ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö performance

## üîÑ Integration

### Google Sheets Backup

‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å backup ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheets ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

### Discord Webhook

‡∏™‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á Discord channel (‡∏ñ‡πâ‡∏≤ configured)

## üí° Best Practices

1. **‡πÉ‡∏ä‡πâ Priority ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°**
   - `high` - ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å (requireInteraction)
   - `medium` - ‡∏õ‡∏Å‡∏ï‡∏¥ (default)
   - `low` - ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô

2. **‡∏Å‡∏≥‡∏´‡∏ô‡∏î Action URL**
   - ‡πÉ‡∏ä‡πâ `actionUrl` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á
   - ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ user ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

3. **‡πÉ‡∏ä‡πâ Related Fields**
   - `relatedTo` - ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á entity
   - `relatedId` - ID ‡∏Ç‡∏≠‡∏á entity
   - ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ track ‡πÅ‡∏•‡∏∞ filter

4. **Expiration Dates**
   - ‡πÉ‡∏ä‡πâ `expiresAt` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
   - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

## üêõ Troubleshooting

### Browser Notification ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ browser ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö permission (`Notification.permission`)
3. ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô HTTPS (production) ‡∏´‡∏£‡∏∑‡∏≠ localhost (development)

### Toast ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á

1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ `react-hot-toast` ‡∏ñ‡∏π‡∏Å import ‡πÉ‡∏ô `app/layout.tsx`
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö console ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö errors

### Notifications ‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï

1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö polling interval
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API response
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö network tab

## üìù Examples

‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô:
- `components/Layout.tsx` - ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° NotificationCenter
- `hooks/useNotifications.ts` - ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ hook
- `app/api/notifications/route.ts` - API endpoints

‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!
